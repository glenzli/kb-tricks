---
name: kb-init
description: "初始化项目的高级编排技能。它会自动驱动 kb-plan 生成蓝图，并在请求用户确认后自动启动 kb-build 执行文档沉淀循环。"
---

# 知识库初始化编排目标 (KB Init Orchestration Goal)
提供“一键式”的知识库构建体验。通过协调 `kb-plan` 和 `kb-build` 两个子技能，实现“AI 规划 -> 用户审查并确认 -> AI 自主分块执行”的完整工作流。

# 工作流指令 (Workflow Instructions)

作为高级编排 Agent，你按照以下流程自主驱动，期间**不要随意中止**，直到需要用户显式确认或全部任务完成。

### 第 1 阶段：自主规划 (Autonomous Planning)
1. 向用户输出状态提示：“正在进行项目架构的宏观扫描与文档规划，请稍候...”
2. **静默调用 `kb-plan` 技能**：遵循 `kb-plan/SKILL.md` 中的指令，不深入代码细节地分析整个仓库，并生成 `KB_PLAN.md` 计划书。
3. 等待 `KB_PLAN.md` 文件在文件系统中成功生成并落盘。

### 第 2 阶段：交互式确认 (Interactive Confirmation)
1. 规划书生成完毕后，**暂停当前执行流**。
2. 将 `KB_PLAN.md` 的核心内容（或摘要）展示给用户。
3. 也就是向用户索取权限：“我已经生成了初步的知识库构建计划书 `KB_PLAN.md`。您可以直接打开该文件查看或修改我想跳过的噪音目录以及计划生成的文档焦点。**您是否确认计划并将方向盘交还给我开始执行？（回复 'ok' 开始构建）**”
4. 挂起等待用户的输入。

### 第 3 阶段：循环执行 (Iterative Execution)
1. 一旦用户回复确认（如 "ok", "确认", "yes"）或者用户修改完 `KB_PLAN.md` 给出了继续指令。
2. 立即进入执行循环。**调用 `kb-build` 技能**，并传递指令：“请严格遵照 `KB_PLAN.md` 中的状态开始分块执行”。
3. 监控 `kb-build` 的产生：每一次 `kb-build` 将某个条目更新为 `[x]` 并生成完一个文件后，在控制台上向用户输出一行简短的进度日志（例如：“已生成 API 认证模块地图: `.agent/kb/api/auth.md`”）。
4. **自主驱动直至完成**：如果遇到 LLM 上下文截断或临时报错，由于 `KB_PLAN.md` 记录了进度，请自动重试调用 `kb-build` 恢复执行。直到 `KB_PLAN.md` 中所有的复选框都被勾选为 `[x]`。

### 第 4 阶段：完工汇报 (Completion Report)
1. 循环结束后，向用户输出总结：“知识库初始化已全部完成。所有的认知地图文档及语义词汇表 (`GLOSSARY.md`) 已存放在指定的文件夹中。”
2. 退出工作流。
